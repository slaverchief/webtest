# Инструкция к пользованию

STACK: **`Go`**,  **`PostgreSQL`**,  **`Gin`**, **Gorm**

Проект из себя представляет веб-приложение для публикации и просмотра объявлений.

## Запуск 
Прежде чем запустить приложение, нужно задать переменные окружения.

Задать переменные окружения можно в файле **app.env**. Он заполнен простыми данными для тестирования: их можно поменять на свое усмотрение.
- **POSTGRES_HOST** - хост, на котором запущен **PostgreSQL**
- **POSTGRES_USER** - пользователь базы данных
- **POSTGRES_PASSWORD** - пароль базы данных
- **POSTGRES_DB** - название базы данных
- **JWT_SECRET** - секретный ключ для генерации токенов авторизации
- **GIN_MODE** - определяет, запустить приложение в режиме релиза или в режиме отладки(release/debug). Можно не указывать, по умолчанию будет режим отладки.

Далее можно запустить приложение командой `go run main.go` в корневой директории или создать образ и запустить докер контейнер командой `docker-compose up`.

## API
### Авторизация
Для авторизации используется middleware, который обрабатывает заголовок Authorization. Для авторизации нужно вставить токен, получаемый при авторизации пользователя, в этот заголовок в формате `Bearer <ТОКЕН>`.

### Эндпоинты
**POST /auth/register** - регистрация пользователя
```json
{
"username": "ИМЯ_ПОЛЬЗОВАТЕЛЯ",
"password": "ПАРОЛЬ"
}
```
Минимальная длина пароля - 5, в пароле должны быть как буквы, так и цифры.

**POST /auth/login** - авторизация пользователя
```json
{
"username": "ИМЯ_ПОЛЬЗОВАТЕЛЯ",
"password": "ПАРОЛЬ"
}
```

**POST /posts/** - создание объявления, **требуется авторизация**
```json
{

"title": "ЗАГОЛОВОК",
"text": "ТЕКСТ",
"image_url": "ССЫЛКА_НА_ИЗОБРАЖЕНИЕ",
"price": ЦЕНА(INT)

}
```

**GET /posts/** - просмотр ленты объявлений, **требуется авторизация**, **принимает URL параметры**
```URL_params
{
sort_by - поле сортировки(название в соответствии с данными в JSON ответе)
sort_order - порядок сортировки(desc/asc)
min_price - минимальная цена
max_price - максимальная цена
page - страница
page_size - количество объявлений в странице
}
```
**page** и **page_size** должны присутствовать оба или не присутствовать вообще